(function(f){function m(){for(var a=arguments[0],b=arguments.length-1;0<b;b--){var c=arguments[b],d;for(d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}return a}function g(a){return function(b){return toString(b)==="[object "+a+"]"}}function k(a){function b(){var a=JSON.parse(localStorage[e.__storageKey__]),b=a.timeStamp;b!==h&&(e.emit(a.eventName,a.eventData),h=b)}l?setTimeout(b,1):b()}g("Object");g("String");Array.isArray||g("Array");g("Function");var n={on:function(a,b){var c=this.events||(this.events=
{});c[a]?c[a].push(b):c[a]=[b]},off:function(a,b){var c=this.events||(this.events={});if(c[a]&&b&&(c=c[a]))for(var d=0,e=c.length;d<e;d++)c[d]==b&&c.splice(d,1)},emit:function(a){var b=this.events||(this.events={}),c=Array.prototype.slice.call(arguments,1);if(b[a]&&(b=b[a]))for(var d=0,e=b.length;d<e;d++){var f=b[d];f.apply(f,c)}}},e=function(a){a.emit&&a.on&&a.off&&a.events||(a.events={},m(a,n));return a}({}),h,l=!!f.attachEvent;e.__storageKey__="__stereo_storage_key__";e.init=function(){f.addEventListener?
f.addEventListener("storage",k,!1):l&&f.document.attachEvent("onstorage",k)};e.broadcast=function(a,b){h=+new Date+Math.random();var c=JSON.stringify({eventName:a,eventData:b,timeStamp:h});localStorage[this.__storageKey__]=c;return this};e.init();f.stereo=e})(window);
